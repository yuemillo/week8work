import{_ as w,g as p,a as q,m as E,r as _,o as r,c as m,d as n,b as e,F as y,h as I,t as b,w as Q,A as V,B as C,C as h}from"./index-bHwTZEbc.js";import{c as k}from"./cartStore-r1R0QTR3.js";var U={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_NAME:"jslong",BASE_URL:"/week8work/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:f,VITE_NAME:v}=U,A={data(){return{isLoading:!0,products:[],tempProduct:{},orderId:this.$route.params.id,status:{addCartLoading:"",cartQtyLoading:""},form:{user:{email:"",name:"",tel:"",address:""},message:""}}},methods:{changeCartQty(a,s=1){const d={product_id:a.product_id,qty:s};this.status.cartQtyLoading=a.id,p.put(`${f}/api/${v}/cart/${a.id}`,{data:d}).then(g=>{console.log(g),this.status.cartQtyLoading="",this.getCart()})},removeCartItem(a){this.status.cartQtyLoading=a,p.delete(`${f}/api/${v}/cart/${a}`).then(s=>{this.status.cartQtyLoading="",alert("已刪除產品"),this.getCart()})},...q(k,["removeAllCartItem","getCart"]),createOrder(){const a=`${f}/api/${v}/order`,s=this.form;p.post(a,{data:s}).then(d=>{alert(d.data.message),this.$refs.form.resetForm(),this.getCart(),this.$router.push(`/order/${d.data.orderId}`)}).catch(d=>{alert(d.response.data.message)})}},computed:{...E(k,["carts","final_total"])},mounted(){this.getCart(),console.log(this.carts),setTimeout(()=>{this.isLoading=!1},500)}},M={id:"app"},S={class:"container"},B={class:"mt-4"},T={class:"text-end"},z={class:"table align-middle"},D=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",{class:"text-end"},"單價")])],-1),R=["onClick","disabled"],N={class:"input-group input-group-sm"},O={class:"input-group mb-3"},F=["disabled","onClick"],H=["onClick"],j=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[e("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),e("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1),P=[j],$=["onUpdate:modelValue","disabled"],G=["onClick"],J={class:"text-end"},K=e("td",{colspan:"3",class:"text-end"},"總計",-1),W={class:"text-end"},X={class:"my-5 row justify-content-center"},Y={class:"mb-3"},Z=e("label",{for:"email",class:"form-label"},"Email",-1),ee={class:"mb-3"},te=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),se={class:"mb-3"},oe=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),ae={class:"mb-3"},le=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ne={class:"mb-3"},de=e("label",{for:"message",class:"form-label"},"留言",-1),ie={class:"text-end"},re=["disabled"];function me(a,s,d,g,l,i){const L=_("VueLoading"),c=_("v-field"),u=_("error-message"),x=_("v-form");return r(),m(y,null,[n(L,{active:l.isLoading},null,8,["active"]),e("div",M,[e("div",S,[e("div",B,[e("div",T,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:s[0]||(s[0]=(...t)=>a.removeAllCartItem&&a.removeAllCartItem(...t))},"清空購物車")]),e("table",z,[D,e("tbody",null,[(r(!0),m(y,null,I(this.carts,t=>(r(),m("tr",{key:t.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>i.removeCartItem(t.id),disabled:l.status.cartQtyLoading===t.id}," x ",8,R)]),e("td",null,b(t.product.title),1),e("td",null,[e("div",N,[e("div",O,[t.qty>1?(r(),m("button",{key:0,type:"button",class:"btn btn-outline-primary",disabled:t.qty===1,onClick:o=>{t.qty--,i.changeCartQty(t,t.qty)}},"-",8,F)):(r(),m("button",{key:1,type:"button",class:"btn btn-outline-danger",onClick:o=>i.removeCartItem(t.id)},P,8,H)),V(e("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":o=>t.qty=o,disabled:t.id===l.status.cartQtyLoading,readonly:""},null,8,$),[[C,t.qty]]),e("button",{type:"button",class:"btn btn-outline-primary",onClick:o=>{t.qty++,i.changeCartQty(t,t.qty)}},"+",8,G)])])]),e("td",J,b(t.total),1)]))),128))]),e("tfoot",null,[e("tr",null,[K,e("td",W,b(a.final_total),1)])])])]),e("div",X,[n(x,{ref:"form",class:"col-md-6",onSubmit:i.createOrder},{default:Q(({errors:t})=>[e("div",Y,[Z,n(c,{id:"email",name:"email",type:"email",class:h(["form-control",{"is-invalid":t.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=o=>l.form.user.email=o)},null,8,["class","modelValue"]),n(u,{name:"email",class:"invalid-feedback"})]),e("div",ee,[te,n(c,{id:"name",name:"姓名",type:"text",class:h(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=o=>l.form.user.name=o)},null,8,["class","modelValue"]),n(u,{name:"姓名",class:"invalid-feedback"})]),e("div",se,[oe,n(c,{id:"tel",name:"電話",type:"tel",class:h(["form-control",{"is-invalid":t.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=o=>l.form.user.tel=o)},null,8,["class","modelValue"]),n(u,{name:"電話",class:"invalid-feedback"})]),e("div",ae,[le,n(c,{id:"address",name:"地址",type:"text",class:h(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=o=>l.form.user.address=o)},null,8,["class","modelValue"]),n(u,{name:"地址",class:"invalid-feedback"})]),e("div",ne,[de,V(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[5]||(s[5]=o=>l.form.message=o)},null,512),[[C,l.form.message]])]),e("div",ie,[e("button",{type:"submit",class:"btn btn-danger",disabled:a.carts.total===0},"送出訂單",8,re)])]),_:1},8,["onSubmit"])])])])],64)}const _e=w(A,[["render",me]]);export{_e as default};
