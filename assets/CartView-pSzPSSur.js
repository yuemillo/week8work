import{_ as U,g as b,a as j,m as D,r as u,o as r,c,d as n,b as e,D as v,w as V,A as _,E as C,F as k,h as M,t as g,f as S,G as w,n as f,p as B,i as N,e as R}from"./index-JNT4IJuC.js";import{S as L}from"./sweetalert2.all-Fm7rLdqG.js";import{c as I}from"./cartStore-309sSctn.js";const T="/week8work/no-d2d1ae91-fee6-432e-a183-b785f3c2ab31.png";var z={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_NAME:"jslong",BASE_URL:"/week8work/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:y,VITE_NAME:x}=z,O={data(){return{isLoading:!0,products:[],tempProduct:{},orderId:this.$route.params.id,status:{addCartLoading:"",cartQtyLoading:""},form:{user:{email:"",name:"",tel:"",address:""},message:""}}},methods:{changeCartQty(a,s=1){const m={product_id:a.product_id,qty:s};this.status.cartQtyLoading=a.id,b.put(`${y}/api/${x}/cart/${a.id}`,{data:m}).then(E=>{this.status.cartQtyLoading="",this.getCart()})},removeCartItem(a){this.status.cartQtyLoading=a,b.delete(`${y}/api/${x}/cart/${a}`).then(s=>{this.status.cartQtyLoading="",L.fire({title:"已刪除產品",position:"top-end",showCancelButton:!1,timer:1500}),this.getCart()})},...j(I,["removeAllCartItem","getCart"]),handleremoveAllCartItem(){this.removeAllCartItem()},createOrder(){const a=`${y}/api/${x}/order`,s=this.form;b.post(a,{data:s}).then(m=>{this.$refs.form.resetForm(),this.getCart(),this.$router.push(`/order/${m.data.orderId}`),L.fire({title:"訂單已送出",position:"top-end",showCancelButton:!1,timer:1500})}).catch(m=>{alert(m.response.data.message)})}},computed:{...D(I,["carts","final_total"]),isSubmitDisabled(){return!this.form.user.email||!this.form.user.name||!this.form.user.tel||!this.form.user.address}},mounted(){this.getCart(),setTimeout(()=>{this.isLoading=!1},500)}},i=a=>(B("data-v-e21ca79c"),a=a(),N(),a),F={id:"app"},H={class:"container mt90"},P={key:0,class:"process d-flex flex-column justify-content-center align-items-center mt-5"},G=R('<div class="process-container mt-5" data-v-e21ca79c><div class="strip bg-primary" data-v-e21ca79c></div><div class="d-flex justify-content-between" data-v-e21ca79c><div class="process01 d-flex justify-content-center align-items-center bg-primary" data-v-e21ca79c><p class="text-white fs-3 m-0" data-v-e21ca79c>1</p></div><div class="process01 d-flex justify-content-center align-items-center border border-3 border-primary bg-white" data-v-e21ca79c><p class="text-black fs-3 m-0" data-v-e21ca79c>2</p></div><div class="process01 d-flex justify-content-center align-items-center border border-3 border-primary bg-white" data-v-e21ca79c><p class="text-black fs-3 m-0" data-v-e21ca79c>3</p></div></div></div><div class="d-flex justify-content-between mt-1" style="width:340px;" data-v-e21ca79c><p data-v-e21ca79c>填寫訂單</p><p data-v-e21ca79c>確認訂單</p><p data-v-e21ca79c>完成訂購</p></div>',2),J=[G],K={class:"mt-4"},W={class:"text-end"},X={key:0,class:"d-flex flex-column align-items-center"},Y=i(()=>e("h2",{class:"fs-1 text-center mt-5"},"購物車是空的",-1)),Z=i(()=>e("img",{src:T,width:"500px",alt:"購物車是空的",class:"mx-auto img-fluid"},null,-1)),$={class:"table align-middle"},ee=i(()=>e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",{class:"text-end"},"單價")])],-1)),te=["onClick","disabled"],se={class:"input-group input-group-sm"},ae={class:"input-group mb-3"},oe=["disabled","onClick"],le=["onClick"],ne=i(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[e("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),e("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1)),ie=[ne],de=["onUpdate:modelValue"],re=["onClick","disabled"],ce={class:"text-end"},me=i(()=>e("td",{colspan:"3",class:"text-end"},"總計",-1)),ue={class:"text-end"},pe={class:"my-5 row justify-content-center"},he={class:"mb-3"},_e=i(()=>e("label",{for:"email",class:"form-label"},"Email",-1)),fe={class:"mb-3"},be=i(()=>e("label",{for:"name",class:"form-label"},"收件人姓名",-1)),ve={class:"mb-3"},ge=i(()=>e("label",{for:"tel",class:"form-label"},"收件人電話",-1)),ye={class:"mb-3"},xe=i(()=>e("label",{for:"address",class:"form-label"},"收件人地址",-1)),Ve={class:"my-3"},Ce=i(()=>e("label",{for:"message",class:"form-label"},[S("留言"),e("span",{class:"text-muted"},"(選填)")],-1)),ke={class:"text-end"},we=["disabled"];function Le(a,s,m,E,l,d){const q=u("VueLoading"),A=u("RouterLink"),p=u("v-field"),h=u("error-message"),Q=u("v-form");return r(),c(k,null,[n(q,{active:l.isLoading},null,8,["active"]),e("div",F,[e("div",H,[this.carts.length!==0?(r(),c("div",P,J)):v("",!0),e("div",K,[e("div",W,[this.carts.length!==0?(r(),c("button",{key:0,class:"btn btn-outline-danger",type:"button",onClick:s[0]||(s[0]=(...t)=>d.handleremoveAllCartItem&&d.handleremoveAllCartItem(...t))},"清空購物車")):v("",!0)]),this.carts.length===0?(r(),c("div",X,[Y,Z,n(A,{class:"text-black text-decoration-none mb-5 fs-3 btn btn-outline-primary",to:"/products"},{default:V(()=>[S("快去選隻喵喵吧!")]),_:1})])):v("",!0),_(e("table",$,[ee,e("tbody",null,[(r(!0),c(k,null,M(this.carts,t=>(r(),c("tr",{key:t.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>d.removeCartItem(t.id),disabled:l.status.cartQtyLoading===t.id}," x ",8,te)]),e("td",null,g(t.product.title),1),e("td",null,[e("div",se,[e("div",ae,[t.qty>1?(r(),c("button",{key:0,type:"button",class:"btn btn-outline-primary",disabled:t.qty===1||t.id===l.status.cartQtyLoading,onClick:o=>{t.qty--,d.changeCartQty(t,t.qty)}},"-",8,oe)):(r(),c("button",{key:1,type:"button",class:"btn btn-outline-danger",onClick:o=>d.removeCartItem(t.id)},ie,8,le)),_(e("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":o=>t.qty=o,readonly:""},null,8,de),[[w,t.qty]]),e("button",{type:"button",class:"btn btn-outline-primary",onClick:o=>{t.qty++,d.changeCartQty(t,t.qty)},disabled:t.id===l.status.cartQtyLoading},"+",8,re)])])]),e("td",ce,g(t.total),1)]))),128))]),e("tfoot",null,[e("tr",null,[me,e("td",ue,g(a.final_total),1)])])],512),[[C,this.carts.length!==0]])]),_(e("div",pe,[n(Q,{ref:"form",class:"col-md-6",onSubmit:d.createOrder},{default:V(({errors:t})=>[e("div",he,[_e,n(p,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":t.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=o=>l.form.user.email=o)},null,8,["class","modelValue"]),n(h,{name:"email",class:"invalid-feedback"})]),e("div",fe,[be,n(p,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=o=>l.form.user.name=o)},null,8,["class","modelValue"]),n(h,{name:"姓名",class:"invalid-feedback"})]),e("div",ve,[ge,n(p,{id:"tel",name:"電話",type:"tel",class:f(["form-control",{"is-invalid":t.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=o=>l.form.user.tel=o)},null,8,["class","modelValue"]),n(h,{name:"電話",class:"invalid-feedback"})]),e("div",ye,[xe,n(p,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=o=>l.form.user.address=o)},null,8,["class","modelValue"]),n(h,{name:"地址",class:"invalid-feedback"})]),e("div",Ve,[Ce,_(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[5]||(s[5]=o=>l.form.message=o)},null,512),[[w,l.form.message]])]),e("div",ke,[e("button",{type:"submit",class:"btn btn-danger",disabled:a.carts.total===0||d.isSubmitDisabled},"送出訂單",8,we)])]),_:1},8,["onSubmit"])],512),[[C,a.carts.length!==0]])])])],64)}const qe=U(O,[["render",Le],["__scopeId","data-v-e21ca79c"]]);export{qe as default};
